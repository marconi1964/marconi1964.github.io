[["index.html", "Jetbot YOLOv4 - AIA Edge AI æŠ€è¡“ç­å°ˆæ¡ˆ Chapter 1 å‰è¨€", " Jetbot YOLOv4 - AIA Edge AI æŠ€è¡“ç­å°ˆæ¡ˆ Marconi Jiang 2021-03-23 Chapter 1 å‰è¨€ æ­¤ç¯‡æ–‡ç« æ˜¯æˆ‘åƒåŠ ç¬¬ä¸€å±†å°ç£äººå·¥æ™ºæ…§å­¸æ ¡ AIA Edge AI æŠ€è¡“ç­æ™‚, åˆ†çµ„çš„ç•¢æ¥­å°ˆæ¡ˆ, å°ˆæ¡ˆåŸºæ–¼ Jetson Nano èˆ‡ YOLOv4 çš„å°‹æ¨™é¿éšœå°è»Šé–‹ç™¼éç¨‹åŠæˆæœ. å› ç‚ºå·²ç¶“å°‡æ‰€æœ‰éç¨‹ç™¼è¡¨æ–¼ github jetbot_yolov4 å°ˆæ¡ˆå®Œæ•´ä»‹ç´¹, å› æ­¤, å°±å°‡åŸä¾†çš„ REAME.md è¤‡è£½è²¼ä¸Šåˆ° bookdown çš„ 01-introduction.Rmd, å®Œå…¨ä¸ä½œæ›´å‹• (é‚„éœ€è¦æƒ³æƒ³ä»¥å¾Œå¦‚æœåœ¨ github ä¸Šä¿®æ”¹å¾Œè¦å¦‚ä½•è‡ªå‹•åŒ–é€™å‹•ä½œ), å°±æ˜¯é€™æœ¬æ›¸çš„å…§å®¹. "],["aia-edge-ai-.html", "Chapter 2 AIA Edge AI æŠ€è¡“ç­ å°ˆæ¡ˆ 2.1 å°ˆæ¡ˆæº–å‚™è³‡æ–™ 2.2 Jetbot é–‹æ©Ÿè¨­å®š 2.3 å°ˆæ¡ˆå•Ÿå‹• 2.4 Car Deploying 2.5 model training è¨“ç·´æ¨¡å‹åŠæ¨¡å‹è½‰æ› 2.6 é–‹è·‘ 2.7 Reference", " Chapter 2 AIA Edge AI æŠ€è¡“ç­ å°ˆæ¡ˆ 2.1 å°ˆæ¡ˆæº–å‚™è³‡æ–™ NVIDIAÂ® Jetson Nanoâ„¢ JETBOT AI ROBOT KIT Jetbot github : éƒ¨ä»½å…§å®¹æ²’æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬, å¦‚ https://github.com/NVIDIA-AI-IOT/jetbot/wiki/software-setup çš„ image ä¸‹è¼‰ç‰ˆæœ¬å·²ç¶“åˆ° JetPack 4.4.1, æ­¤æ–‡é‚„åœç•™åœ¨ JetPack 4.3. Jetbot.org WaveShare JetBot AI Kit å®‰è£èªªæ˜ ROS (Robot OS) ROS æ¨¡æ“¬ NVIDIA JetBot Gazebo Simulation èªªæ˜ 2.2 Jetbot é–‹æ©Ÿè¨­å®š åƒè€ƒæ­¤ç¯‡æ–‡ç«  https://jetbot.org/master/index.html åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ &gt; 1. ä¸‹è¼‰åŠç‡’éŒ„ image &gt; - æˆ‘ç”¨çš„æ˜¯ 4GB çš„ç‰ˆæœ¬ &gt; - ç°¡å–®åˆ¤æ–· 2GB æˆ– 4GB çš„æ–¹å¼ï¼šçœ‹å……é›»çš„æ¥é ­æ˜¯ micro USB çš„æ˜¯ for Jetson Nano (4GB), æˆ–æ˜¯ USB-C (for Jetson Nano 2GB) Platform JetPack Version JetBot Version Download Jetson Nano (4GB) 4.4.1 0.4.2 jetbot-042_nano-4gb-jp441.zip 2. login çš„ id è·Ÿ password éƒ½æ˜¯ jetbot 3. å¦‚æœé–‹æ©Ÿæ™‚é€²å…¥çš„æ˜¯ command line æ¨¡å¼, å¯ä»¥åƒè€ƒä»¥ä¸‹æŒ‡ä»¤, é€²å…¥ GUI æ¨¡å¼ https://imadelhanafi.com/posts/jetson_nano_setup/ å› ç‚º, å¾…æœƒå…’çš„ examples ç¨‹å¼ä¹‹ä¸€ teleoperation éœ€è¦ç”¨åˆ°éŠæˆ²æ‰‹æŠŠ ğŸ® æ§åˆ¶å™¨, æˆ‘åœ¨ Mac ä¸Šæ“ä½œ notebook æ™‚æœ‰å•é¡Œ, åªæœ‰åœ¨ Jetbot ä¸Šç›´æ¥åŸ·è¡Œæ™‚æ‰ okay. # disable GUI on boot # After applying this command, the next time you reboot it will be on terminal mode $ sudo systemctl set-default multi-user.target # To enable GUI again $ sudo systemctl set-default graphical.target 4. è¨­å®š wifi çš„ command line æŒ‡ä»¤, è¦è¨˜å¾— reboot æ‰èƒ½ç”Ÿæ•ˆ $ sudo nmcli device wifi connect &lt;SSID&gt; password &lt;PASSWORD&gt; Device &#39;wlan0&#39; successfully activate with &#39;27xxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&#39;. $ 5. å®‰è£ VNC - åƒè€ƒ Jetson Nano é–‹æ©Ÿç•«é¢ä¸Šçš„ L4T-README ç›®éŒ„ä¸‹çš„ README-vnc.txt - è¦æ³¨æ„çš„æ˜¯, vnc éœ€è¦ log in å¾Œæ‰èƒ½åŸ·è¡Œ, éœ€è¦åˆ°ç³»çµ±è¨­å®šå…§å»è¨­å®š automatic log in. - åŸ·è¡Œä¸‹åˆ— script ä¾†å®‰è£ vino ï¼ˆvnc ç¨‹å¼ï¼‰åŠç›¸é—œè¨­å®š - å°‡ â€˜thepasswordâ€™ æ”¹æˆä½ è¨­å®šçš„å¯†ç¢¼, å¦‚ â€˜jetbotâ€™ $ sudo apt update $ sudo apt install vino # Enable the VNC server to start each time you log in $ mkdir -p ~/.config/autostart $ cp /usr/share/applications/vino-server.desktop ~/.config/autostart # Configure the VNC server $ gsettings set org.gnome.Vino prompt-enabled false $ gsettings set org.gnome.Vino require-encryption false # Set a password to access the VNC server # Replace thepassword with your desired password $ gsettings set org.gnome.Vino authentication-methods &quot;[&#39;vnc&#39;]&quot; $ gsettings set org.gnome.Vino vnc-password $(echo -n &#39;thepassword&#39;|base64) $ 6. ä¿®æ”¹ /etc/X11/xorg.conf, å°‡ä¸‹åˆ—è¨­å®šåŠ æ–¼æª”æ¡ˆæœ€å¾Œ - è§£æåº¦çš„ 1280 800 æ˜¯æœ€ä½³è¨­å®š, èª¿æ•´æˆå…¶å®ƒè§£æåº¦å¾Œ, ç„¡æ³•åœ¨ Mac ä¸Šçœ‹åˆ°å®Œæ•´è¢å¹•, éœ€è¦ä¸Šä¸‹èª¿æ•´, åè€Œä¸æ–¹ä¾¿ Section &quot;Screen&quot; Identifier &quot;Default Screen&quot; Monitor &quot;Configured Monitor&quot; Device &quot;Tegra0&quot; SubSection &quot;Display&quot; depth 24 virtual 1280 800 EndSubSection EndSection 7. GPIO (40 PIN expansion header) è¨­å®š - æ ¹æ“šå®˜ç¶² Configuring the 40-pin Expansion Header, åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ä¾†è¨­å®šç¡¬é«” - åƒè€ƒä¸­æ–‡èªªæ˜ ç¬¬ä¸€æ¬¡ç”¨Jetson nano å°±ä¸Šæ‰‹ - ä½¿ç”¨40 pin GPIO - é¸æ“‡ Configure 40-pin Expansion Header, è¨­å®šç›¸é—œçš„è…³ä½ï¼ˆè‹¥æ²’æŠŠæ¡, å°±å…¨é¸ï¼‰, å†é¸æ“‡ Save and reboot to reconfigure pins. é‡æ–°é–‹æ©Ÿå¾Œ. $ sudo /opt/nvidia/jetson-io/jetson-io.py $ 8. å®‰è£ jtop åœ¨ Jetson ä¸­æœ‰ä¸€å€‹éå¸¸å¥½ç”¨çš„å·¥å…·å°±æ˜¯ jtopï¼Œå¯ä»¥åŒæ™‚æŸ¥çœ‹ CPU è³‡æºèˆ‡ GPU è³‡æºï¼Œå¦å¤–ä¹Ÿå¯ä»¥çœ‹ç›®å‰ CPU èˆ‡ GPU çš„æº«åº¦èˆ‡åŠŸè€—ï¼Œå¦å¤–ä»–é‚„æœ‰è²¼å¿ƒçš„æœå‹™ï¼Œå°±æ˜¯å°‡ä½ ç›®å‰çš„ library show å‡ºä¾†ã€‚ $ sudo apt-get install python-pip python-dev build-essential $ sudo -H pip install jetson-stats $ sudo jtop $ 9. é‡æ–°é–‹æ©Ÿå¾Œ, å…ˆåˆ° Jetbot çš„ LED ä¸ŠæŸ¥çœ‹ wlan çš„ IP ä½å€, æˆ‘æŸ¥åˆ°çš„æ˜¯ 192.168.1.16 10. åˆ° PC æˆ– Mac çš„ browers, æ‰“é–‹ http://jetbot_ip_address:8888 (æˆ‘çš„ä¾‹å­å°±æ˜¯ http://192.169.1.16:8888). æˆ–è€…æ˜¯ç›´æ¥åœ¨ Jetbot ä¸ŠåŸ·è¡Œ, éœ€è¦é€²å…¥ jetbot çš„ GUI æ¨¡å¼, æ‰“é–‹ browser, è¼¸å…¥ http://localhost:8888 11. Create Linux OS disk SWAP, refer to the link åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ # ç†æƒ³çš„SWAP sizeæ‡‰æ˜¯RAMçš„äºŒå€ï¼Œä½†ç”±æ–¼SDç©ºé–“ä¸æ˜¯å¾ˆå……è£•ï¼Œå…ˆè¨­å®š 4G æˆ– 8G SWAPã€‚ $ sudo fallocate -l 8G /swapfile $ sudo chmod 600 /swapfile $ ls -lh /swapfile # å»ºç«‹ä¸¦å•Ÿç”¨SWAP $ sudo mkswap /swapfile $ sudo swapon /swapfile $ sudo swapon â€“show # è¼¸å…¥free -hç¢ºèªå·²ç¶“æœ‰ 4G æˆ– 8G SWAPç©ºé–“äº† free â€“h # ç”±æ–¼é‡é–‹æ©Ÿå¾ŒSWAPè¨­å®šä¾¿æœƒè·‘æ‰ï¼Œå› æ­¤ï¼ŒæŠŠSWAPåŠ åˆ°fstabè¨­å®šæª”ä¸­ã€‚ $ sudo cp /etc/fstab /etc/fstab.bak $ echo &#39;/swapfile none swap sw 0 0&#39; | sudo tee -a /etc/fstab 2.3 å°ˆæ¡ˆå•Ÿå‹• 2.3.0.1 å¾ JetPack 4.4.1 ï¼ˆJetbot 0.4.2) å¾—æ”¯æ´ 2GB ç‰ˆæœ¬, å› æ­¤ remove ä¸å°‘å¥—ä»¶, è€Œä¸”å¾ command line é–‹æ©Ÿ, å› æ­¤, å³ä½¿æˆ‘å€‘ç”¨çš„æ˜¯ 4GB ç‰ˆæœ¬, é‚„æ˜¯å¾—å®‰è£è¨±å¤šå¥—ä»¶ 1. Install Jetbot $ sudo apt update $ sudo apt install libffi-dev python3-pip $ sudo pip3 install ipywidgets $ sudo pip3 install traitlets # package already satified $ cd ~/jetbot $ sudo python3 setup.py install 2. Install Pytorch in order to run jetbot module, the instrution can be refer to https://forums.developer.nvidia.com/t/pytorch-for-jetson-version-1-7-0-now-available/72048. for latest version $ sudo apt-get install libopenblas-base libopenmpi-dev $ pip3 install Cython $ wget https://nvidia.box.com/shared/static/9eptse6jyly1ggt9axbja2yrmj6pbarc.whl -O torch-1.7.0-cp36-cp36m-linux_aarch64.whl $ pip3 install numpy torch-1.7.0-cp36-cp36m-linux_aarch64.whl 3. CUDA ç’°å¢ƒè¨­å®š, åƒè€ƒJKJung JetPack-4.4 for Jetson Nano å»ºè­°çš„ Basic set-up çš„ ./install_basics.sh $ git clone https://github.com/jkjung-avt/jetson_nano.git $ cd jetson_nano $ ./install_basics.sh $ source ${HOME}/.bashrc $ æˆ–æ˜¯è‡ªè¡Œè¨­å®š # If you used the Jetson Nano SD card image, then yes, it already has the CUDA Toolkit installed. Check under /usr/local/cuda to verify that itâ€™s there. # Check that your ~/.bashrc file has these lines at the end, and if not, add them and restart your terminal: export PATH=/usr/local/cuda/bin${PATH:+:${PATH}} export LD_LIBRARY_PATH=/usr/local/cuda/lib64${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}} 4. Making sure python3 â€œcv2â€ is working # Install dependencies for python3 &quot;cv2&quot; $ sudo apt-get update $ sudo apt-get install -y build-essential make cmake cmake-curses-gui \\ git g++ pkg-config curl libfreetype6-dev \\ libcanberra-gtk-module libcanberra-gtk3-module $ sudo apt-get install -y python3-dev python3-testresources python3-pip $ sudo pip3 install -U pip Cython $ git clone https://github.com/jkjung-avt/jetson_nano.git $ cd ${HOME}/jetson_nano $ ./install_protobuf-3.8.0.sh # will take hours to complete the installation $ sudo apt-get install protobuf-compiler libprotoc-dev $ sudo pip3 install numpy matplotlib==3.2.2 # æ¸¬è©¦ Then I tested my tegra-cam.py script with a USB webcam, and made sure the python3 â€œcv2â€ module could capture and display images properly. # Test tegra-cam.py (using a USB webcam) $ cd ~ $ wget https://gist.githubusercontent.com/jkjung-avt/86b60a7723b97da19f7bfa3cb7d2690e/raw/3dd82662f6b4584c58ba81ecba93dd6f52c3366c/tegra-cam.py # å¦‚æœæ˜¯ç”¨ CSI camera $ python3 tegra-cam.py --vid 0 # å¦‚æœæ˜¯ç”¨ USB camera $ python3 tegra-cam.py --usb --vid 0 5. Installing tensorflow-1.15.2 NVIDIA has provided pip wheel files for both tensorflow-1.15.2 and tensorflow-2.2.0 (link). I used 1.15.2 since my TensorRT Demo #3: SSD only works for tensorflow-1.x. $ sudo apt-get install -y libhdf5-serial-dev hdf5-tools libhdf5-dev zlib1g-dev zip libjpeg8-dev liblapack-dev libblas-dev gfortran $ sudo pip3 install -U pip testresources setuptools $ sudo pip3 install -U numpy==1.16.1 future mock h5py==2.10.0 keras_preprocessing keras_applications gast==0.2.2 futures pybind11 $ sudo pip3 install --pre --extra-index-url https://developer.download.nvidia.com/compute/redist/jp/v44 tensorflow==1.15.2 2.4 Car Deploying åƒè€ƒ https://github.com/jkjung-avt/tensorrt_demos Demo #5: YOLOv4 æ­¥é©ŸåŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ # Clone tennsorrt_demo $ cd ~ $ git clone https://github.com/jkjung-avt/tensorrt_demos # 1.1 Install &quot;pycuda&quot;. Note that the installation script resides in the &quot;ssd&quot; folder. $ cd ${HOME}/tensorrt_demos/ssd $ ./install_pycuda.sh # 1.2 Install version &quot;1.4.1&quot; (not the latest version) of python3 &quot;onnx&quot; module. Note that the &quot;onnx&quot; module would depend on &quot;protobuf&quot; as stated in the Prerequisite section. Reference: information provided by NVIDIA. $ sudo apt-get install protobuf-compiler libprotoc-dev # already the newest version $ sudo pip3 install onnx==1.4.1 # 1.3 Go to the &quot;plugins/&quot; subdirectory and build the &quot;yolo_layer&quot; plugin. When done, a &quot;libyolo_layer.so&quot; would be generated. $ cd ${HOME}/tensorrt_demos/plugins $ make 2.5 model training è¨“ç·´æ¨¡å‹åŠæ¨¡å‹è½‰æ› åƒè€ƒ JK Jung çš„ github çš„ training on Google Colab, åŠæ³¨æ„äº‹é … blog TensorRT YOLOv3 For Custom Trained Models - æ³¨æ„æª”æ¡ˆå‘½å, æª”æ¡ˆåç¨±éœ€è¦åŒ…å« yolov4-416 å­—æ¨£, å¦‚ yolov4-my-416.weights è·Ÿ yolov4-my-416.cfg æˆ– yolov4-416.weights è·Ÿ yolov4-416.cfg 1-1. åœ¨ Google Colab åŸ·è¡Œ â€˜darknet_on_colab.ipynbâ€™ ä¸Šå‚³ github darknet_on_colab.ipynb åˆ° colab remember to change runtime type to â€˜GPUâ€™ å„²å­˜æ¨¡å‹ yolov4_my_final.weights (darknet å„²å­˜æ–¼ /content/darknet/backup/) è·Ÿ yolov4_my.cfg (darknet å„²å­˜æ–¼ /content/darknet/cfg/) åˆ° Jetson Nano çš„ ${HOME}/tensorrt_demos/yolo ä¸‹, ä¸¦æ”¹åç‚º yolov4-416.weights è·Ÿ yolov4-416.cfg 1-2. å¦‚æœæ˜¯åœ¨ Server ä¸ŠåŸ·è¡Œ, åƒè€ƒ README_CUDA_installation.md è·Ÿ README_training_on_server.md åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ $ git clone https://github.com/marconi1964/jetbot_yolov4.git $ cd jetbot_yolov4 $ ./server_darknet_setup.sh # don&#39;t use $ sudo ./server_darknet_setup.sh æ‡‰ç‚ºé€™æ¨£æœƒå®‰è£ darknet åœ¨ /root ä¸‹ $ ./server_darknet.sh Model translation from to onnx to tensorrt $ cd ${HOME}/tensorrt_demos/yolo # å°‡è¨“ç·´æ¨¡å‹çš„çµæœä¸‹è¼‰åˆ°æ­¤ç›®éŒ„ä¸‹ $ python3 yolo_to_onnx.py -c 4 -m yolov4-416 # æˆ‘å€‘çš„ catergory æœ‰ 4 å€‹, éœ€è¦è¨­å®š -c 4 $ python3 onnx_to_tensorrt.py -v -c 4 -m yolov4-416 # æ­¤è½‰æª”éœ€è¦ä¸€æ®µæ™‚é–“, æ‰“é–‹ -v å¯ä»¥çœ‹åˆ°é€²åº¦ 2.6 é–‹è·‘ ä¸‹è¼‰ github - jetbot_yolov4 å°‡ main.py copy åˆ° tensorrt_demos åŸ·è¡Œ python3 jetbot_main.py $ cd ~ $ git clone https://github.com/marconi1964/jetbot_yolov4.git $ cp ${HOME}/jetbot_yolov4/main.py ${HOME}/tensorrt_demos $ cd ${HOME}/tensorrt_demos $ python3 jetbot_main.py 2.7 Reference JK Jung / Inventec PPT - Applications of Real-time Object Detection on NVIDIA Jetson TX2 Github : https://github.com/jkjung-avt/ Github : Training a DarkNet YOLOv4 model for custimized dataset Blog : https://jkjung-avt.github.io/ Blog : TensorRT YOLOv3 For Custom Trained Models Darknet - AlexeyAB Darknet - Pjreddie åƒè€ƒ Derek åŒå­¸çš„ github å¯«å®Œå¾Œ, ä¸å°å¿ƒç™¼ç¾ä¸€ç¯‡ç¾å¥³å¯«çš„æ–‡ç« , YOLOv4è¨“ç·´æ•™å­¸. å¥¹é€™ä¸€ç¯‡çµ•å°æ¯”æˆ‘å¯«çš„æœ‰å¸å¼•åŠ›. é‚„æœ‰ä¸€ç¯‡é¡ä¼¼çš„, ä»¥ video ç‚ºç¯„ä¾‹çš„ Implementing YOLOv4 to detect custom objects using Google Colab YOLOv4 - Ten Tactics to Build a Better Model How to train YOLOv4 for custom objects detection in Google Colab "]]
